# Лабораторна робота №4: HTTP-сервер на Node.js

## Опис

Простий HTTP-сервер на Node.js, який читає дані про польоти з JSON файлу та повертає відфільтровані результати у XML форматі.

## Варіант 2: flights-1m.json

Сервер працює з великим набором даних польотної інформації (1 мільйон записів), що включає затримки та скасування.

## Встановлення

1. Клонуйте репозиторій
2. Встановіть залежності:
```bash
npm install
```

## Використання

### Запуск сервера

```bash
node main.js --input flights-1m.json --host localhost --port 3000
```

### Запуск з автоматичним перезавантаженням (для розробки)

```bash
npm run dev -- --input flights-1m.json --host localhost --port 3000
```

## Параметри командного рядка

- `-i, --input` - (обов'язковий) шлях до файлу з даними
- `-h, --host` - (обов'язковий) адреса сервера
- `-p, --port` - (обов'язковий) порт сервера

## API

### GET /

Повертає дані про польоти у XML форматі.

#### Query параметри

- `date=true` - відображати дату польоту (поле FL_DATE) у результаті
- `airtime_min=X` - відображати лише записи літаків, час у повітрі яких (AIR_TIME) був довший за заданий X

#### Приклади запитів

```bash
# Базовий запит
curl "http://localhost:3000"

# Запит з датою
curl "http://localhost:3000?date=true"

# Фільтрація за мінімальним часом у повітрі
curl "http://localhost:3000?airtime_min=400"

# Комбінація параметрів
curl "http://localhost:3000?date=true&airtime_min=400"
```

#### Приклад відповіді

```xml
<flights>
  <flight>
    <air_time>350</air_time>
    <distance>2475</distance>
    <date>2006-01-01</date>
  </flight>
  <flight>
    <air_time>343</air_time>
    <distance>2475</distance>
    <date>2006-01-02</date>
  </flight>
</flights>
```

## Структура проекту

```
├── main.js              # Основний файл програми
├── package.json         # Конфігурація проекту та залежності
├── flights-1m.json      # Дані про польоти
├── .gitignore          # Файли для ігнорування Git
└── README.md           # Документація
```

## Залежності

- **commander** - для роботи з аргументами командного рядка
- **fast-xml-parser** - для генерації XML з JavaScript об'єктів
- **nodemon** (dev) - для автоматичного перезапуску сервера під час розробки

## Особливості fast-xml-parser

fast-xml-parser - це швидкий та ефективний пакет для парсингу та побудови XML у Node.js. Основні особливості:

### Переваги:
- **Швидкість**: Один з найшвидших XML парсерів для JavaScript
- **Легкість використання**: Простий API для перетворення JSON в XML
- **Налаштування**: Гнучкі опції форматування та конфігурації
- **Підтримка**: Активна підтримка та розвиток

### Основні можливості:
- Перетворення JavaScript об'єктів в XML
- Налаштування форматування (відступи, порожні теги)
- Підтримка атрибутів XML
- Валідація XML структури

### Приклад використання в проекті:

```javascript
const { XMLBuilder } = require('fast-xml-parser');

const builder = new XMLBuilder({
  format: true,          // Форматувати вивід
  indentBy: '  ',       // Відступи (2 пробіли)
  suppressEmptyNode: true // Приховувати порожні теги
});

const xmlData = {
  flights: {
    flight: [
      { air_time: 350, distance: 2475 },
      { air_time: 343, distance: 2475 }
    ]
  }
};

const xml = builder.build(xmlData);
```

## Обмеження

- Для оптимізації продуктивності сервер повертає максимум 1000 записів за запит
- У заголовках відповіді вказується загальна кількість знайдених записів (`X-Total-Records`) та кількість повернутих (`X-Returned-Records`)

## Автор

Студент backend-course-2025-4
